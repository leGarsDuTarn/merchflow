<div class="container mt-5 mb-5">

  <!-- EN-T√äTE AVEC RETOUR -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <%= link_to admin_users_path, class: "btn btn-orange-outline rounded-pill px-3" do %>
      <i class="fa-solid fa-arrow-left me-2"></i>Retour
    <% end %>

    <% if @user.fve? %>
      <span class="badge bg-gray text-orange fs-6 px-3 py-2 rounded-pill">
        <i class="fa-solid fa-briefcase me-2"></i>Compte FVE
      </span>
    <% else %>
      <span class="badge bg-gray text-orange fs-6 px-3 py-2 rounded-pill">
        <i class="fa-solid fa-user me-2"></i>Compte Merch
      </span>
    <% end %>
  </div>

  <div class="row">

    <!-- COLONNE GAUCHE : IDENTIT√â -->
    <div class="col-lg-8">
      <div class="card shadow-sm rounded-4 border-0 mb-4 h-100">
        <div class="card-body p-4">

          <div class="d-flex align-items-center mb-4">
            <div class="bg-light rounded-circle d-flex align-items-center justify-content-center text-orange fw-bold fs-3 me-3" style="width: 60px; height: 60px;">
              <%= @user.firstname.first.upcase %><%= @user.lastname.first.upcase %>
            </div>
            <div>
              <h2 class="fw-bold m-0"><%= @user.full_name %></h2>
              <p class="text-muted m-0 small">Inscrit le <%= @user.created_at.strftime("%d/%m/%Y") %></p>
            </div>
          </div>

          <hr class="opacity-10 my-4">

          <div class="row g-4">

            <!-- Email -->
            <div class="col-md-6">
              <label class="text-muted small fw-bold text-uppercase mb-1">Email</label>
              <div class="d-flex align-items-center">
                <i class="fa-solid fa-envelope text-orange me-2"></i>
                <span class="fw-semibold"><%= @user.email %></span>
              </div>
            </div>

            <!-- T√©l√©phone -->
            <div class="col-md-6">
              <label class="text-muted small fw-bold text-uppercase mb-1">T√©l√©phone</label>
              <div class="d-flex align-items-center">
                <i class="fa-solid fa-phone text-orange me-2"></i>
                <span class="fw-semibold"><%= @user.phone_number.presence || "Non renseign√©" %></span>
              </div>
            </div>

            <!-- üî• SPECIFIQUE FVE : AGENCE -->
            <% if @user.fve? %>
              <div class="col-12">
                <div class="bg-light p-3 rounded-3 border border-primary border-opacity-25">
                  <label class="text-primary small fw-bold text-uppercase mb-2">
                    <i class="fa-solid fa-building me-1"></i> Agence de rattachement
                  </label>
                  <div class="fs-4 fw-bold text-dark">
                    <%= Contract::AGENCY_LABELS[@user.agency] || @user.agency.to_s.humanize %>
                  </div>
                  <small class="text-muted">Cet utilisateur ne voit que les missions de cette agence.</small>
                </div>
              </div>
            <% end %>

            <!-- SPECIFIQUE MERCH : ADRESSE -->
            <% if @user.merch? %>
              <div class="col-12">
                <label class="text-muted small fw-bold text-uppercase mb-1">Adresse</label>
                <div class="d-flex align-items-start">
                  <i class="fa-solid fa-location-dot text-orange me-2 mt-1"></i>
                  <span>
                    <%= @user.address %><br>
                    <%= @user.zipcode %> <%= @user.city %>
                  </span>
                </div>
              </div>
            <% end %>

          </div>

        </div>
      </div>
    </div>

    <!-- COLONNE DROITE : STATUT & ACTIONS -->
    <div class="col-lg-4">

      <!-- Carte Premium -->
      <div class="card shadow-sm rounded-4 border-0 mb-4">
        <div class="card-body p-4">
          <h5 class="fw-bold mb-3">Statut du compte</h5>

          <div class="d-flex justify-content-between align-items-center mb-3">
            <span class="fw-semibold">Premium</span>
            <% if @user.premium? %>
              <span class="badge bg-success rounded-pill px-3">Actif</span>
            <% else %>
              <span class="badge bg-secondary rounded-pill px-3">Inactif</span>
            <% end %>
          </div>

          <p class="text-muted small mb-3">
            <% if @user.fve? %>
              Le Premium permet au FVE de voir les coordonn√©es (t√©l√©phone/email) des Merchs.
            <% else %>
              Le Premium permet au Merch d'acc√©der aux fonctionnalit√©s avanc√©es.
            <% end %>
          </p>

          <%= link_to toggle_premium_admin_user_path(@user),
                      class: "btn btn-red w-100  #{@user.premium? ? 'btn-outline-danger' : 'btn-orange'}",
                      data: { turbo_method: :patch } do %>
            <% if @user.premium? %>
              <i class="fa-solid fa-ban me-2"></i>D√©sactiver Premium
            <% else %>
              <i class="fa-solid fa-star me-2"></i>Activer Premium
            <% end %>
          <% end %>

        </div>
      </div>

      <!-- Actions Admin (Suppression, Edit...) -->
      <div class="card shadow-sm rounded-4 border-0">
        <div class="card-body p-4">
          <h5 class="fw-bold mb-3 text-danger">Zone de danger</h5>

          <p class="text-muted small">Attention, ces actions sont irr√©versibles.</p>

          <%= button_to admin_user_path(@user),
                        method: :delete,
                        class: "btn btn-red w-100",
                        form: { data: { turbo_confirm: "√ätes-vous s√ªr de vouloir supprimer cet utilisateur ?" } } do %>
            <i class="fa-solid fa-trash me-2"></i>Supprimer le compte
          <% end %>
        </div>
      </div>

    </div>
  </div>

</div>
