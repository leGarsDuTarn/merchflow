<div class="col-md-6 col-lg-4">
  <div class="card shadow-sm rounded-4 h-100 border-0">

    <% header_class = case proposal.status
       when 'pending' then 'bg-warning-subtle text-warning-emphasis'
       when 'accepted' then 'bg-success-subtle text-success-emphasis'
       else 'bg-danger-subtle text-danger-emphasis'
       end %>

    <div class="card-header <%= header_class %> rounded-top-4 fw-bold d-flex justify-content-between align-items-center">
      <span>
        <% if proposal.pending? %>⏳ En attente
        <% elsif proposal.accepted? %>✅ Acceptée
        <% else %>❌ <%= proposal.status.humanize %>
        <% end %>
      </span>
      <small><%= l proposal.created_at.to_date, format: :default %></small>
    </div>

    <div class="card-body">
      <h5 class="card-title fw-bold mb-1">
        <i class="fa-solid fa-user-circle me-1 text-muted"></i>
        <%= proposal.merch.full_name %>
      </h5>
      <p class="text-muted small mb-3">Envoyé à <%= proposal.merch.city %></p>

      <div class="d-flex align-items-center mb-2">
        <i class="fa-solid fa-calendar-day text-orange me-2" style="width:20px"></i>
        <strong><%= l proposal.date, format: :long %></strong>
      </div>

      <div class="d-flex align-items-center mb-2">
        <i class="fa-solid fa-clock text-orange me-2" style="width:20px"></i>
        <%= proposal.start_time.strftime('%H:%M') %> - <%= proposal.end_time.strftime('%H:%M') %>
      </div>

      <div class="d-flex align-items-center mb-2">
        <i class="fa-solid fa-building text-orange me-2" style="width:20px"></i>
        <span class="text-truncate"><%= proposal.company %></span>
      </div>

      <div class="d-flex align-items-center mb-3">
        <i class="fa-solid fa-store text-orange me-2" style="width:20px"></i>
        <span class="text-truncate"><%= proposal.store_name %></span>
      </div>

      <hr>

      <div class="d-flex justify-content-between align-items-center">
        <div>
          <span class="text-muted small">Taux :</span>
          <span class="fw-bold"><%= number_to_currency(proposal.hourly_rate) %>/h</span>
        </div>
        <div>
          <span class="text-muted small">KM :</span>
          <span class="fw-bold"><%= proposal.effective_km.to_i %> km</span>
        </div>
      </div>

      <% if proposal.message.present? %>
        <div class="mt-3 p-2 bg-light rounded small fst-italic text-muted">
          "<%= truncate(proposal.message, length: 80) %>"
        </div>
      <% end %>

    </div>
  </div>
</div>
